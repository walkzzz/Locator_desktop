# Locator_desktop - 桌面应用元素定位工具

## 项目简介

Locator_desktop是一款功能强大的桌面应用程序定位工具，旨在解决当前使用pywinauto和uiautomation库进行桌面应用元素定位时遇到的操作复杂、定位不准确、兼容性差等痛点问题。

## 功能特性

- ✅ **直观的用户界面**：清晰的布局设计，易于使用
- ✅ **实时元素捕获**：支持鼠标悬停或拖拽选择目标元素
- ✅ **多种定位方式**：
  - 属性定位：基于元素属性（如automation_id、name、class_name等）
  - 图像识别定位：通过图像匹配定位元素
  - 坐标定位：基于屏幕坐标定位
- ✅ **自动代码生成**：
  - 支持生成pywinauto定位代码
  - 支持生成uiautomation定位代码
  - 生成的代码可直接使用
- ✅ **元素树展示**：以树形结构清晰展示UI元素层级关系
- ✅ **元素详细信息**：显示选中元素的完整属性信息
- ✅ **定位验证**：实时测试生成的定位代码是否有效
- ✅ **兼容性分析**：针对不同应用类型优化定位策略
- ✅ **支持多种应用类型**：MFC、WinForms、WPF、Qt等

## 技术栈

- **编程语言**：Python 3.8+
- **GUI框架**：PyQt5
- **核心依赖**：
  - pywinauto
  - uiautomation
  - opencv-python
  - pillow
  - pygetwindow
  - psutil

## 项目结构

```
LocatorProject/
├── src/
│   ├── main.py              # 应用入口
│   ├── ui/
│   │   └── main_window.py   # 主窗口UI类
│   ├── core/
│   │   ├── element.py          # 元素数据结构
│   │   ├── element_capture.py  # 元素捕获核心逻辑
│   │   ├── element_analyzer.py # 元素分析模块
│   │   ├── code_generator.py   # 定位代码生成器
│   └── utils/
│       ├── window_utils.py     # 窗口操作工具
│       └── process_utils.py    # 进程管理工具
├── requirements.txt           # 项目依赖
└── README.md                  # 项目说明
```

## 安装与运行

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行应用

```bash
python src/main.py
```

## 使用指南

1. **选择目标应用**：
   - 在顶部工具栏的应用程序输入框中输入应用路径
   - 或从进程列表中选择正在运行的应用
   - 或从窗口列表中选择目标窗口

2. **捕获元素**：
   - 点击"捕获元素"按钮
   - 将鼠标移动到目标元素上
   - 按下Ctrl键确认捕获

3. **查看元素信息**：
   - 捕获的元素将显示在元素树中
   - 点击元素树中的元素，查看详细信息
   - 在右侧面板中查看元素的属性、定位路径和生成的代码

4. **生成定位代码**：
   - 在右侧下方的代码生成区域查看自动生成的定位代码
   - 支持切换pywinauto和uiautomation两种代码格式
   - 点击"复制代码"按钮将代码复制到剪贴板

5. **测试定位**：
   - 点击"测试定位"按钮验证生成的定位代码是否有效
   - 根据提示信息确认定位结果

## 定位方式说明

### 属性定位

基于元素的属性进行定位，推荐使用，定位稳定可靠。

**适用场景**：
- 元素具有唯一的automation_id
- 元素具有稳定的name或class_name
- 适用于大多数标准控件

### 图像识别定位

通过图像匹配技术定位元素，适用于难以通过属性定位的元素。

**适用场景**：
- 自定义控件
- 图像按钮
- 属性不唯一或不稳定的元素

### 坐标定位

基于屏幕坐标定位元素，简单直接但不稳定。

**适用场景**：
- 快速定位
- 测试环境固定的场景

## 常见问题与解决方案

### 1. 无法捕获到目标元素

**解决方案**：
- 确保目标应用正在运行且可见
- 尝试切换不同的捕获方式
- 检查应用是否为支持的类型（MFC、WinForms、WPF、Qt等）

### 2. 生成的定位代码无效

**解决方案**：
- 检查元素属性是否唯一
- 尝试使用其他定位方式
- 确保目标应用没有更新或UI变化

### 3. 应用启动失败

**解决方案**：
- 检查Python版本是否为3.8+
- 确保所有依赖已正确安装
- 查看错误日志，定位具体问题

## 开发说明

### 项目扩展

- 支持更多自动化库的代码生成
- 实现元素定位历史记录功能
- 支持批量元素捕获和代码生成
- 提供定位代码导出功能
- 支持云端元素库管理

### 贡献指南

1. Fork项目
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启Pull Request

## 许可证

本项目采用MIT许可证 - 查看[LICENSE](LICENSE)文件了解详情

## 联系方式

如有问题或建议，欢迎通过以下方式联系：

- 项目地址：[GitHub Repository]()
- 邮箱：[your-email@example.com]

## 更新日志

### v1.0.0 (2025-12-18)

- 初始版本发布
- 实现核心功能
- 支持pywinauto和uiautomation代码生成
- 支持多种定位方式
- 提供直观的用户界面

## 致谢

感谢所有为项目做出贡献的开发者和用户！
